sequenceDiagram
  participant U as کاربر
  participant UI as رابط کاربری
  participant API as API
  participant P as تأمین‌کننده
  participant PG as درگاه پرداخت
  participant N as سرویس اعلان

  U->>UI: انتخاب گزینه و ورود اطلاعات مسافر
  UI->>API: POST /bookings
  API->>P: بازبینی ظرفیت/قیمت
  P-->>API: تأیید/عدم‌تأیید
  alt تأیید شد
    API->>PG: شروع پرداخت
    PG-->>U: هدایت به صفحه پرداخت
    U-->>PG: انجام پرداخت
    PG-->>API: بازگشت به callback
    API->>PG: راستی‌آزمایی پرداخت
    PG-->>API: نتیجه راستی‌آزمایی
    alt پرداخت موفق
      API->>P: درخواست صدور
      P-->>API: نتیجه صدور
      API->>N: ارسال اعلان خرید
      N-->>U: پیام/ایمیل تأیید
    else پرداخت ناموفق/مبهم
      API-->>UI: پیام خطا/نیازمند بررسی
    end
  else رد شد
    API-->>UI: پیام تغییر قیمت/عدم موجودی
  end

